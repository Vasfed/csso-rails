<%
# template for single-file csso lib

def file(filename)
  File.read(filename).strip
end

def version package
  require 'json'
  JSON.parse(File.read(package))['version']
end

%>/*
<%= " THIS FILE IS AUTOGENERATED! DO NOT EDIT!\n See #{__FILE__} instead." %>

 Based on <%= version 'csso/package.json' %> revision <%= file 'csso/.git/refs/heads/master' %>
*/

console = {
  log: function(){},
  error: function(txt){
    throw txt;
  }
};

<%= file 'csso/dist/csso-browser.js' %>

do_compression = function(css, disable_structural){
   return csso.minify(css, {
        restructure: !disable_structural
    });
};

do_compression_with_map = function(css, filename, structural){
   var result = csso.minify(css, {
        restructure: structural,
        filename: filename,
        sourceMap: true
    });
  return [result.css, result.map.toString()];
};
